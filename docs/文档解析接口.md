# 文档解析接口

[[_TOC_]]

## 需求描述

需要算提供对以下四种格式的文档：PDF（图片或文字）、Word、Excel、PPT，提供文字内容提取接口，且输出的文字格式要求跟文档里面的排版尽量一致（demo需要给客户展示提取出来的文字内容）。
本接口由工程调用获取文字内容，然后把文字内容通过上面“知识库管理”接口进行数据训练，支撑后续的“知识库匹配”效果。

## 接口定义

`/hitachi_elevator/doc/parse`

### 入参说明（multipart/form-data）

- `file` (file): 上传文件，支持 `pdf/doc/docx/xls/xlsx/ppt/pptx`。
- `file_name` (string, 可选): 原始文件名。
- `file_type` (string, 可选): `pdf`/`word`/`excel`/`ppt`，不传则自动识别。
- `output_format` (string, 可选): `text`（默认）或 `html`。

### 入参示例

使用 `multipart/form-data` 上传文件。

### 出参示例

```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "file_name": "电梯维保说明书.pdf",
    "file_type": "pdf",
    "page_count": 12,
    "content": "第一章 设备概述\n1.1 适用范围...\n\n第二章 注意事项...\n---PAGE_BREAK---\n第三章 ...",
    "content_html": "<h1>第一章 设备概述</h1><p>1.1 适用范围...</p>"
  }
}
```

- `content` 按文档结构保留段落/换行，页分隔使用 `---PAGE_BREAK---`。
- `content_html` 仅在 `output_format=html` 时返回，用于更接近原排版展示。
