# 智能填单接口

[[_TOC_]]

## 需求说明

实现基于对话内容，提取对应填表元素并输出。
填表元素：咨询/投诉内容、所在地区（提取完整的省市区街道或小区地址）、使用人（使用单位）名称、联系人姓名、联系人电话。
由工程调用的算法接口，输入对话记录，接收填表元素。
本功能预计在一通对话里面调用2~N次，每产生两轮调用一次，结束通话在调用一次。
中间过程，要求算法判断比较准确才输出，不能完全确定或置信度只有50%，可以不输出结果。
结束通话的调用，建议每一个字段都要有结果，置信度低一些也可以。

## 接口定义

`/hitachi_elevator/smart_fill`

### 入参示例

```json
{
  "session_id": "call_20241224_001",
  "call_type": "mid",
  "turn_id": 12,
  "history": [
    {
      "role": "user",
      "text": "我们小区电梯这两天老是停在12楼不开门。"
    },
    {
      "role": "agent",
      "text": "请问具体地址和联系人电话？"
    }
  ]
}
```

- `session_id` (string): 通话唯一标识。
- `call_type` (string): `mid` 表示中间过程调用，`final` 表示结束通话调用。
- `turn_id` (int): 当前轮次编号（用于幂等/排查）。
- `history` (array): 当前对话上下文，按时间正序。
  - `role` (string): `user` 或 `agent`。
  - `text` (string): ASR 转写文本。

### 出参示例

```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "complaint_content": {
      "value": "电梯多次停在12楼不开门",
      "evidence": "电梯这两天老是停在12楼不开门"
    },
    "address": {
      "value": "广东省广州市天河区XX小区",
      "evidence": "我们小区"
    },
    "org_name": {
      "value": "",
      "evidence": ""
    },
    "contact_name": {
      "value": "",
      "evidence": ""
    },
    "contact_phone": {
      "value": "",
      "evidence": ""
    }
  }
}
```

- 中间过程如无法确认字段，可返回空字符串或直接省略对应字段。
- `evidence` 用于展示/验收，取自原对话的关键片段。
